<style>
@font-face {
	font-family: octicons-link;
	src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}

.markdown-body {
	-ms-text-size-adjust: 100%;
	-webkit-text-size-adjust: 100%;
	line-height: 1.5;
	color: #24292e;
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
	font-size: 16px;
	line-height: 1.5;
	word-wrap: break-word;
}

.markdown-body .pl-c {
	color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
	color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
	color: #6f42c1;
}

.markdown-body .pl-smi,
.markdown-body .pl-s .pl-s1 {
	color: #24292e;
}

.markdown-body .pl-ent {
	color: #22863a;
}

.markdown-body .pl-k {
	color: #d73a49;
}

.markdown-body .pl-s,
.markdown-body .pl-pds,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sre,
.markdown-body .pl-sr .pl-sra {
	color: #032f62;
}

.markdown-body .pl-v,
.markdown-body .pl-smw {
	color: #e36209;
}

.markdown-body .pl-bu {
	color: #b31d28;
}

.markdown-body .pl-ii {
	color: #fafbfc;
	background-color: #b31d28;
}

.markdown-body .pl-c2 {
	color: #fafbfc;
	background-color: #d73a49;
}

.markdown-body .pl-c2::before {
	content: "^M";
}

.markdown-body .pl-sr .pl-cce {
	font-weight: bold;
	color: #22863a;
}

.markdown-body .pl-ml {
	color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
	font-weight: bold;
	color: #005cc5;
}

.markdown-body .pl-mi {
	font-style: italic;
	color: #24292e;
}

.markdown-body .pl-mb {
	font-weight: bold;
	color: #24292e;
}

.markdown-body .pl-md {
	color: #b31d28;
	background-color: #ffeef0;
}

.markdown-body .pl-mi1 {
	color: #22863a;
	background-color: #f0fff4;
}

.markdown-body .pl-mc {
	color: #e36209;
	background-color: #ffebda;
}

.markdown-body .pl-mi2 {
	color: #f6f8fa;
	background-color: #005cc5;
}

.markdown-body .pl-mdr {
	font-weight: bold;
	color: #6f42c1;
}

.markdown-body .pl-ba {
	color: #586069;
}

.markdown-body .pl-sg {
	color: #959da5;
}

.markdown-body .pl-corl {
	text-decoration: underline;
	color: #032f62;
}

.markdown-body .octicon {
	display: inline-block;
	vertical-align: text-top;
	fill: currentColor;
}

.markdown-body a {
	background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
	outline-width: 0;
}

.markdown-body strong {
	font-weight: inherit;
}

.markdown-body strong {
	font-weight: bolder;
}

.markdown-body h1 {
	font-size: 2em;
	margin: 0.67em 0;
}

.markdown-body img {
	border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
	font-family: monospace, monospace;
	font-size: 1em;
}

.markdown-body hr {
	box-sizing: content-box;
	height: 0;
	overflow: visible;
}

.markdown-body input {
	font: inherit;
	margin: 0;
}

.markdown-body input {
	overflow: visible;
}

.markdown-body [type="checkbox"] {
	box-sizing: border-box;
	padding: 0;
}

.markdown-body * {
	box-sizing: border-box;
}

.markdown-body input {
	font-family: inherit;
	font-size: inherit;
	line-height: inherit;
}

.markdown-body a {
	color: #0366d6;
	text-decoration: none;
}

.markdown-body a:hover {
	text-decoration: underline;
}

.markdown-body strong {
	font-weight: 600;
}

.markdown-body hr {
	height: 0;
	margin: 15px 0;
	overflow: hidden;
	background: transparent;
	border: 0;
	border-bottom: 1px solid #dfe2e5;
}

.markdown-body hr::before {
	display: table;
	content: "";
}

.markdown-body hr::after {
	display: table;
	clear: both;
	content: "";
}

.markdown-body table {
	border-spacing: 0;
	border-collapse: collapse;
}

.markdown-body td,
.markdown-body th {
	padding: 0;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body h1 {
	font-size: 32px;
	font-weight: 600;
}

.markdown-body h2 {
	font-size: 24px;
	font-weight: 600;
}

.markdown-body h3 {
	font-size: 20px;
	font-weight: 600;
}

.markdown-body h4 {
	font-size: 16px;
	font-weight: 600;
}

.markdown-body h5 {
	font-size: 14px;
	font-weight: 600;
}

.markdown-body h6 {
	font-size: 12px;
	font-weight: 600;
}

.markdown-body p {
	margin-top: 0;
	margin-bottom: 10px;
}

.markdown-body blockquote {
	margin: 0;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 0;
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
	x-list-style-type: lower-roman;
	  list-style-type: decimal;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
	list-style-type: lower-alpha;
}

.markdown-body dd {
	margin-left: 0;
}

.markdown-body code {
	font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
	font-size: 12px;
}

.markdown-body pre {
	margin-top: 0;
	margin-bottom: 0;
	font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
	font-size: 12px;
}

.markdown-body .octicon {
	vertical-align: text-bottom;
}

.markdown-body .pl-0 {
	padding-left: 0 !important;
}

.markdown-body .pl-1 {
	padding-left: 4px !important;
}

.markdown-body .pl-2 {
	padding-left: 8px !important;
}

.markdown-body .pl-3 {
	padding-left: 16px !important;
}

.markdown-body .pl-4 {
	padding-left: 24px !important;
}

.markdown-body .pl-5 {
	padding-left: 32px !important;
}

.markdown-body .pl-6 {
	padding-left: 40px !important;
}

.markdown-body::before {
	display: table;
	content: "";
}

.markdown-body::after {
	display: table;
	clear: both;
	content: "";
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body a:not([href]) {
	color: inherit;
	text-decoration: none;
}

.markdown-body .anchor {
	float: left;
	padding-right: 4px;
	margin-left: -20px;
	line-height: 1;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 0.25em;
	padding: 0;
	margin: 24px 0;
	background-color: #e1e4e8;
	border: 0;
}

.markdown-body blockquote {
	padding: 0 1em;
	color: #6a737d;
	border-left: 0.25em solid #dfe2e5;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body kbd {
	display: inline-block;
	padding: 3px 5px;
	font-size: 11px;
	line-height: 10px;
	color: #444d56;
	vertical-align: middle;
	background-color: #fafbfc;
	border: solid 1px #c6cbd1;
	border-bottom-color: #959da5;
	border-radius: 3px;
	box-shadow: inset 0 -1px 0 #959da5;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	margin-top: 24px;
	margin-bottom: 16px;
	font-weight: 600;
	line-height: 1.25;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	color: #1b1f23;
	vertical-align: middle;
	visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	visibility: visible;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2em;
	border-bottom: 1px solid #eaecef;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.5em;
	border-bottom: 1px solid #eaecef;
}

.markdown-body h3 {
	font-size: 1.25em;
}

.markdown-body h4 {
	font-size: 1em;
}

.markdown-body h5 {
	font-size: 0.875em;
}

.markdown-body h6 {
	font-size: 0.85em;
	color: #6a737d;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li {
	word-wrap: break-all;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body li+li {
	margin-top: 0.25em;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: 600;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
}

.markdown-body table th {
	font-weight: 600;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #dfe2e5;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f6f8fa;
}

.markdown-body img {
	max-width: 100%;
	box-sizing: content-box;
	background-color: #fff;
}

.markdown-body img[align=right] {
	padding-left: 20px;
}

.markdown-body img[align=left] {
	padding-right: 20px;
}

.markdown-body code {
	padding: 0.2em 0.4em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(27,31,35,0.05);
	border-radius: 3px;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f6f8fa;
	border-radius: 3px;
}

.markdown-body pre code {
	display: inline;
	max-width: auto;
	padding: 0;
	margin: 0;
	overflow: visible;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body .full-commit .btn-outline:not(:disabled):hover {
	color: #005cc5;
	border-color: #005cc5;
}

.markdown-body kbd {
	display: inline-block;
	padding: 3px 5px;
	font: 11px "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
	line-height: 10px;
	color: #444d56;
	vertical-align: middle;
	background-color: #fafbfc;
	border: solid 1px #d1d5da;
	border-bottom-color: #c6cbd1;
	border-radius: 3px;
	box-shadow: inset 0 -1px 0 #c6cbd1;
}

.markdown-body :checked+.radio-label {
	position: relative;
	z-index: 1;
	border-color: #0366d6;
}

.markdown-body .task-list-item {
	list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
	margin-top: 3px;
}

.markdown-body .task-list-item input {
	margin: 0 0.2em 0.25em -1.6em;
	vertical-align: middle;
}

.markdown-body hr {
	border-bottom-color: #eee;
}

</style>
<style>
ol {
    display: block;
    list-style-type: decimal;
}
.pagebreak { page-break-before: always; }
.half { height: 200px; }
</style>

<div class="markdown-body">

<style>
.pagebreak { page-break-before: always; }
.half { height: 200px; }
</style>
<style>
.pagebreak { page-break-before: always; }
.half { height: 200px; }
.markdown-body {
    font-size: 12px;
}
.markdown-body td {
    font-size: 12px;
}
</style>

<h1>Lecture 23 - web3.js client example</h1>

<p>To setup MetaMask to work with truffle:
<a href="https://trufflesuite.com/docs/truffle/getting-started/truffle-with-metamask">https://trufflesuite.com/docs/truffle/getting-started/truffle-with-metamask</a></p>

<p>The Truffle PetShop Tutorial:
<a href="https://trufflesuite.com/guides/pet-shop/">https://trufflesuite.com/guides/pet-shop/</a></p>

<h2>Steps</h2>

<ol>
<li>Setting up the development environment ( you should be able to write, build, compile a contact at this point )</li>
<li>Writing the smart contract</li>
<li>Compiling and migrating the smart contract</li>
<li>Testing the smart contract</li>
<li>Creating a user interface to interact with the smart contract</li>
<li>Running a &ldquo;server&rdquo;</li>
<li>Interacting with the dApp in a browser</li>
</ol>

<h2>Setting up the development environment</h2>

<p>Use git to clone this repository <code>./eth</code>.
If you move this to a different path then <code>cd eth ; rm -rf build</code> to get rid of the
old build (it has paths in it that are now wrong).   Then recompile to build again.</p>

<pre><code>$ truffle compile
</code></pre>

<p>Use truffle to pull out a pre-built environment like the pet-shop.</p>

<p>Remember to run ganache with the web-sockets turned on.</p>

<pre><code>$ ganache  --server.ws 
</code></pre>

<p>Check MetaMask configuration to get it to talk to gouache
ganache at</p>

<pre><code>RPC Listening on 127.0.0.1:8545
</code></pre>

<p>Save the list of accounts - we may need that later and it is unique
each time you run ganache</p>

<pre><code>Available Accounts
==================
(0) 0x31D7f4435fAcd54A4941447624f8Dd2024e0382D (1000 ETH)
(1) 0x97FCbbFa2B46d7e8f572864E917d91B9FaA53a71 (1000 ETH)
(2) 0xEF712f61EA21d683d9eA4b11f927B24cDB373F74 (1000 ETH)
(3) 0x9d934D43B20607ce1B5096D21fb7C6C1F9d50b56 (1000 ETH)
(4) 0x79668fF2E8e12570B96E342Ac1362B3a3bF6eE47 (1000 ETH)
(5) 0xa82998A94C94132a154a2Ce1a5A49F587648Db7a (1000 ETH)
(6) 0xe34fA6f30f22F87639055FEa72653Fb4785263e0 (1000 ETH)
(7) 0x27CbED781f167fCDe94BE5578F4d801c0F7E83B6 (1000 ETH)
(8) 0x1F54130FB40E97FD49c9cEF928958494Da20A030 (1000 ETH)
(9) 0x6827Db0342cd1EC78D12735dFE5898bf9685d262 (1000 ETH)

Private Keys
==================
(0) 0xb3128b28ab6963f34170ddafa2cf820e160110c0ef4f0c8b70b6e71f40199566
(1) 0x3afce7e5e265fceee780167905da8b0b9e398a93cbd978f129a504f0874dbf95
(2) 0xdcd7fb4f680e1b0220024fe381cd8685a496e59bafab894c02212e8faf7dd54f
(3) 0xd1005931c634c4758b8f64f7b706243978c12b065b0cf0c0e6d8591ec75e3404
(4) 0x6ff4eb43bb56a6b2ec91630870781c009e1d2857db7af1e1a167ca57972f04b8
(5) 0x09d2f7a43e1a55c307cf2d16decf0ddb3bfd0159c8ef6b0abd31c88aea85fb03
(6) 0x7b0768ba75b9fbc95330befd30b8a8c11fec71fee6d2bb97c13636c984f92978
(7) 0xf4f6088707b1b2376b60e545c4b6f01452a5a2c58ce7111bd3345f9db3edbb2e
(8) 0x6483311ee5caef63d8a5004ff20d459b4e1d8a3ce4b95753de04d9cf6e780e1e
(9) 0xbb0e78a03ae7db784cf544b7d72d25f71d7a8bdbc51600737f05fbc1df9ae48f
</code></pre>

<p>Remember that you have to load your contracts every time you start
ganache.</p>

<pre><code>$ truffle migrate --reset
</code></pre>

<p>Save the output from the migrate (Look at <code>migrate/3_saved_message.js</code></p>

<pre><code>3_saved_message.js
==================

   Replacing 'SavedMessage'
   ------------------------
   &gt; transaction hash:    0x6f9415fed8259623c80ca000ddba00d8ea0db003aa3a8dcfb98106b928910dec
   &gt; Blocks: 0            Seconds: 0
   &gt; contract address:    0xD0C9933ed2f7022177E4fa572F3Ce7DFb0f2B8C7
   &gt; block number:        85
   &gt; block timestamp:     1647633386
   &gt; account:             0x31D7f4435fAcd54A4941447624f8Dd2024e0382D
   &gt; balance:             999.924376116511205725
   &gt; gas used:            320309 (0x4e335)
   &gt; gas price:           2.500015457 gwei
   &gt; value sent:          0 ETH
   &gt; total cost:          0.000800777451016213 ETH

   &gt; Saving migration to chain.
   &gt; Saving artifacts
   -------------------------------------
   &gt; Total cost:     0.000800777451016213 ETH

</code></pre>

<p>File: migrations/3_saved_message.js:</p>

<pre><code>
</code></pre>

<h2>Writing the smart contract</h2>

<p>Write your new smart contract.  In this case we are going to use a Hello World contract.</p>

<pre><code>  1: // SPDX-License-Identifier: MIT
  2: pragma solidity &gt;=0.4.22 &lt;0.9.0;
  3: 
  4: contract SavedMessage {
  5:     string public currentMessage = &quot;Hello World, from Ethereum&quot;;
  6: 
  7:     constructor() {
  8:     }
  9: 
 10:     function getCurrentMessageTxt() external view returns (string memory) {
 11:         return currentMessage;
 12:     }
 13: 
 14:     function setCurrentMessageTxt(string calldata _msg) external {
 15:         currentMessage = _msg;
 16:     }
 17: }

</code></pre>

<h2>Compiling and migrating the smart contract</h2>

<p>Check that your migration file is correct for any new contracts.
The stuff in the <code>./migrations</code> directory is run by sorted order, hence the 1<em>, 2</em> etc.</p>

<pre><code>$ truffle migrate --reset
</code></pre>

<h2>Testing the smart contract</h2>

<pre><code>$ truffle test
</code></pre>

<p>output:</p>

<p><img src="truffle-test-out.png" alt="truffle-test-out.png" /></p>

<p>You <em>have to copy the files from ./build/contract into ../client/contract</em>.  This is in the Makefile.</p>

<h2>Creating a user interface to interact with the smart contract</h2>

<p>2 Files on the client side:</p>

<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
	&lt;link rel=&quot;shortcut icon&quot; type=&quot;image/png&quot; href=&quot;favicon.png&quot; /&gt;
    &lt;title&gt;Hello World dApp&lt;/title&gt;
&lt;style&gt;
.button-style {
   background: #3D94F6;
   background-image: -webkit-linear-gradient(top, #3D94F6, #1E62D0);
   background-image: -moz-linear-gradient(top, #3D94F6, #1E62D0);
   background-image: -ms-linear-gradient(top, #3D94F6, #1E62D0);
   background-image: -o-linear-gradient(top, #3D94F6, #1E62D0);
   background-image: -webkit-gradient(to bottom, #3D94F6, #1E62D0);
   -webkit-border-radius: 6px;
   -moz-border-radius: 6px;
   border-radius: 6px;
   color: #FFFFFF;
   font-family: Arial;
   font-size: 12px;
   font-weight: 300;
   padding: 11px;
   -webkit-box-shadow: 1px 1px 20px 0 #000000;
   -moz-box-shadow: 1px 1px 20px 0 #000000;
   box-shadow: 1px 1px 20px 0 #000000;
   text-shadow: 1px 1px 20px #000000;
   border: solid #337FED 0;
   text-decoration: none;
   display: inline-block;
   cursor: pointer;
   text-align: center;
}

.button-style:hover {
   border: solid #337FED 1px;
   background: #1E62D0;
   background-image: -webkit-linear-gradient(top, #1E62D0, #3D94F6);
   background-image: -moz-linear-gradient(top, #1E62D0, #3D94F6);
   background-image: -ms-linear-gradient(top, #1E62D0, #3D94F6);
   background-image: -o-linear-gradient(top, #1E62D0, #3D94F6);
   background-image: -webkit-gradient(to bottom, #1E62D0, #3D94F6);
   -webkit-border-radius: 6px;
   -moz-border-radius: 6px;
   border-radius: 6px;
   text-decoration: none;
   border: solid #337FED 0;
}
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Hello World dApp&lt;/h1&gt;
    &lt;br/&gt;

	&lt;div id=&quot;output_area&quot;&gt;
		&lt;h2&gt;Current Message&lt;/h2&gt;
		&lt;dd&gt;
			&lt;h3 id=&quot;data_output&quot;&gt;&lt;/h3&gt;
		&lt;/dd&gt;
	&lt;/div&gt;

    &lt;div style=&quot;border:1px solid black;width:300px;&quot;&gt;
		&lt;h4 style=&quot;position:relative;top:-20px;left:3px;&quot;&gt; Change Message &lt;/h4&gt;
		&lt;div style=&quot;margin-left:20px;margin-right:20px;margin-bottom:20px;&quot;&gt;
			&lt;form id=&quot;form&quot; style=&quot;margin-top:-20px;&quot;&gt;
				&lt;input id=&quot;input&quot; type=&quot;text&quot; style=&quot;width:250px;&quot;/&gt; &lt;br&gt;
				&lt;br&gt;
				&lt;input class=&quot;button-style&quot; type=&quot;submit&quot; value=&quot;New Message&quot; /&gt;
			&lt;/form&gt;
		&lt;/div&gt;
	&lt;/div&gt;

    &lt;script type=&quot;text/javascript&quot; src=&quot;node_modules/jquery/dist/jquery.min.js&quot;&gt;&lt;/script&gt;
	&lt;script&gt;
		$(&quot;#output_area&quot;).hide();
	&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;node_modules/web3/dist/web3.min.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;src/app.js&quot;&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;

</code></pre>

<p>and</p>

<p>The file that all the work happens in:</p>

<pre><code>  1: // getWeb3 connects to MetaMask with the local server and starts the web3 library.
  2: // Function from MetaMask Documenation.
  3: const getWeb3 = () =&gt; {
  4:     return new Promise((resolve, reject) =&gt; {
  5:         window.addEventListener(&quot;load&quot;, async () =&gt; {
  6:             if (window.ethereum) {
  7:                 const web3 = new Web3(window.ethereum);
  8:                 try {
  9:                     // Get the users accounts - request permission to use them in MetaMask
 10:                     await window.ethereum.request({ method: &quot;eth_requestAccounts&quot; });
 11:                     resolve(web3);
 12:                 } catch (error) {
 13:                     reject(error);
 14:                 }
 15:             } else {
 16:                 reject(&quot;Please Install MetaMask - Required for this web-application to work.&quot;);
 17:             }
 18:         });
 19:     });
 20: };
 21: 
 22: // Get access to a contract - pulls in the ABI.
 23: // Function from MetaMask Documenation.
 24: const getContract = async (web3) =&gt; {
 25:     const ABI = await $.getJSON(&quot;./contracts/SavedMessage.json&quot;);
 26: 
 27:     const netId = await web3.eth.net.getId();
 28:     const deployedNetwork = ABI.networks[netId];
 29:     const contrctBindABI = new web3.eth.Contract( ABI.abi, deployedNetwork &amp;&amp; deployedNetwork.address );
 30:     return contrctBindABI;
 31: };
 32: 
 33: // displayData will show modified data on the user interface.
 34: const displayData = async (contractHandle, contract) =&gt; {
 35:     contractHandle = await contract.methods.getCurrentMessageTxt().call();
 36:     $(&quot;#output_area&quot;).show();
 37:     $(&quot;#data_output&quot;).html(contractHandle);
 38: };
 39: 
 40: // bindToForm assicates functions with a form on the web page.
 41: const bindToFormX = (contractHandle, contract, accounts) =&gt; {
 42:     let input;
 43: 
 44:     // Collect new input.
 45:     $(&quot;#input&quot;).on(&quot;change&quot;, (evnt) =&gt; {
 46:         input = evnt.target.value;
 47:     });
 48: 
 49:     // Handle form submission.  Call the contract to change the message.
 50:     $(&quot;#form&quot;).on(&quot;submit&quot;, async (evnt) =&gt; {
 51:         evnt.preventDefault(); // Stop form from taking &quot;action&quot; and submitting to server.
 52:         await contract.methods.setCurrentMessageTxt(input).send({ from: accounts[0], gas: 40000 });
 53:         // updateGreeting is the method in the contract
 54:         displayData(contractHandle, contract); // Display modified data.
 55:     });
 56: };
 57: 
 58: // runApp will:
 59: //    1. get connection to accounts (getWeb3)
 60: //  2. get set of accounts.
 61: //  3. display current data.
 62: //  4. Setup to handle form.
 63: async function runApp() {
 64:     let contractHandle;
 65: 
 66:     const web3 = await getWeb3();
 67:     const accounts = await web3.eth.getAccounts();
 68:     const contract = await getContract(web3);
 69: 
 70:     displayData(contractHandle, contract);
 71:     bindToFormX(contractHandle, contract, accounts);
 72: 
 73:     setInterval(function(){
 74:         displayData(contractHandle, contract);
 75:     }, 1000);
 76: }
 77: 
 78: runApp();

</code></pre>

<h2>Running a &ldquo;server&rdquo;</h2>

<pre><code>$ npm run start
</code></pre>

<p>or with a Go server</p>

<pre><code>$ cd simple-go-server
$ go build
$ cd ../client
$ ./simple-server/simple-go-server --dir . --port 3004
</code></pre>

<h2>Interacting with the dApp in a browser</h2>

<p>Demo&hellip;</p>

</div>

